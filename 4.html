<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>瀑布流</title>
	<style>
		*{margin: 0;padding: 0}
		#container{position: relative;}
		.box{float: left;padding: 5px;}
		.imgBox{padding: 5px;box-shadow: 0 0 5px #ccc;border: 1px solid #ccc;border-radius: 5px;}
		.imgBox img{width: 250px;height: auto;}
	</style>
</head>
<body>
	<div id="container">
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/0.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/1.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/2.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/3.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/4.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/5.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/6.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/0.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/1.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/2.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/3.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/4.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/5.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/6.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/0.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/1.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/2.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/3.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/4.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/5.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/6.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/0.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/1.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/2.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/3.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/4.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/5.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/6.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/0.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/1.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/2.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/3.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/4.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/5.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/6.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/0.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/1.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/2.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/3.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/4.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/5.jpg" alt="1">
			</div>
		</div>
		<div class="box">
			<div class="imgBox">
				<img src="../BOMDOM/image/6.jpg" alt="1">
			</div>
		</div>
		<!-- <div style="clear:both;"></div> -->
	</div>
</body>
</html>
<script>
	window.onload = function(){
		imgCount('container','box');
	}
	//计算每行的宽度和摆放图片的张数
	function imgCount(parent,child){
		//获取父级元素
		var parent = document.getElementById(parent);
		//获取所有容器子元素
		var childArr = getAllChild(parent,child);
		//获取屏幕的宽度
		var screenW = document.screenWidth||document.documentElement.clientWidth;
		//获取父元素下任意一个元素 用于计算宽度
		var tagW = parent.getElementsByTagName('*')[0];
		//计数没行能容纳的图片数量
		var num = Math.floor(screenW/tagW.offsetWidth);
		//设置父元素的宽度和居中对齐
		parent.style.cssText = 'width:'+tagW.offsetWidth*num+'px;margin:0 auto';
		//获取每行的最小高度
		var minHeight = getMinHeight(childArr,num);
	};

	//获取所有子元素函数
	function getAllChild(parent,classname){
		//获取父元素下所有的标签
		var aChild = parent.getElementsByTagName('*');
		//设置用于存放box子元素的数组
		var childArr = [];
		// 遍历aChild中的所有元素，
		for (var i = 0; i < aChild.length; i++) {
			// 判断每个值的classname是不是指定的类名
			if (aChild[i].className==classname) {
				//把符合条件的元素存入子元素数组中
				childArr.push(aChild[i]);
			}
		}
		return childArr;
	};

	//获取每行最小高度函数
	function getMinHeight(childArr,num){
		//新建数组，用于存放每行所有元素高度值
		var minHeightArr = [];
		//遍历所有元素
		for (var i = 0; i < childArr.length; i++) {
				//当图片在第一行时，计算高度，并存入高度数组
			if (i<num) {
				minHeightArr[i] = childArr[i].offsetHeight;
			}else{
				//如果图片超过第一行，则超出的部分在前一行最低的图片下面摆放
				//获取最小高度
				var minH = Math.min.apply(null,minHeightArr);
				//得到最小高度元素的下标
				var minHeiIndex = getMinHeiIndex(minHeightArr,minH);
				//设置图片的定位方式为绝对定位
				childArr[i].style.position = 'absolute';
				//设置图片的位置
				//left值为第一行当前索引值的left值
				childArr[i].style.left = childArr[minHeiIndex].offsetLeft+'px';
				//高为最小高度
				childArr[i].style.top = minH+'px';
				//将放置图片过后的高度增加到最小高度
				minHeightArr[minHeiIndex] += childArr[i].offsetHeight;
			}
		}
	};
	//获取最小高度元素索引函数
	function getMinHeiIndex(minHeightArr,minH){
		//遍历最小高度数组
		for (var i = 0; i < minHeightArr.length; i++) {
			//如果最小高度数组中的值==最小高度时
			if (minHeightArr[i]==minH) {
				// 返回当前值的索引
				return i;
			}
		}
	};

</script>