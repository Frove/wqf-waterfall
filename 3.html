<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>瀑布流小试</title>
    <style>
        *{
            margin: 0px;
            padding: 0px;
        }
        /*将主容器的布局方式设置为相对布局*/
        #contianer{
            position: relative;
        }
        .box{
            padding: 5px;
            float: left;
        }
        /*将承载图片的容器定制颜色及边框大小和圆角*/
        .boximg{
            padding: 5px;
            box-shadow: 0 0 5px #ccc;
            border: 1px solid #cccccc;
            border-radius: 5px;
        }
        /*定制图片尺寸*/
        .boximg img{
            width: 250px;
            height: auto;
        }
    </style>
</head>
<body>
    <div id="container">
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/0.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/1.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/2.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/3.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/4.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/5.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/6.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/7.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/8.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/9.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/10.jpg">
            </div>
        </div>
        <div class="box">
            <div class="boximg">
                <img src="../BOMDOM/image/11.jpg">
            </div>
        </div>
    </div>
</body>
</html>
<script>
    window.onload = function(){
        //调用瀑布流实现函数
        waterFlow('container','box');
    };
    //瀑布流实现函数
    function waterFlow(parent,child){
        //获取父级div，最外层容器
        var wparent = document.getElementById(parent);
        //获取所有的class为box的容器div
        //调用获取子div的函数
        var allArr = getAllChild(wparent,child);
        // 获取屏幕的宽度
        var wscreenWidth = document.documentElement.clientWidth;
        //获取所有的标签
        var wchildWidth = wparent.getElementsByTagName('*');
        //计算宽度 计算每行可以容纳的图片数量
        var num = Math.floor(wscreenWidth/wchildWidth[0].offsetWidth);
        // 固定每行的摆放个数 和上下左右外间距 
        wparent.style.cssText = 'width:'+wchildWidth[0].offsetWidth*num+'px;margin:0 auto';
        // 获取每行的最小高度
        getMinHeightOfCols(allArr,num);
    };
    //利用className获取子div的函数
    function getAllChild(parent,classname){
        // 获取所有的标签
        var wchild = parent.getElementsByTagName('*');
        //创建数组
        var childArr = [];
        //遍历wchild，将其中className等于classname(传入的参数)相同的标签放入数组childArr中
        for (var i = 0; i < wchild.length; i++) {
            if (wchild[i].className==classname) {
                //在数组最后插入
                childArr.push(wchild[i]);
            }
        }
        //返回该数组
        return childArr;
    }
    //获取最小行高的函数
    function getMinHeightOfCols(childArr,num){
        //创建数组，放置每行的高度
        var onlyOneColsArr = [];
        for (var i = 0; i < childArr.length; i++) {
            if (i<num) {
                //把第一行的图片单独抽出，寻找最小高度的图片
                onlyOneColsArr[i]=childArr[i].offsetHeight;
            }else{
                //超过第一行的图片则在最小高度上继续摆放图片
                //min.apply获取最小值
                var getMinHeightOfCols = Math.min.apply(null,onlyOneColsArr);
                //得到最小高度图片下标
                var minHeightOfindex = getminIndex(onlyOneColsArr,getMinHeightOfCols);
                //设置为绝对定位
                childArr[i].style.position = 'absolute';
                //得到下一行图片的放置的位置
                childArr[i].style.top = getMinHeightOfCols+'px';
                childArr[i].style.left = childArr[minHeightOfindex].offsetLeft+'px';
                //将最小图片的高度变为放置图片的高度之和
                onlyOneColsArr[minHeightOfindex] += childArr[i].offsetHeight;
            }
        }
    };
//找到最小高度图片索引的函数
function getminIndex(onlyOneColsArr,min){
    //遍历传进来的高度的数组
    for(var i in onlyOneColsArr){
        //如果高度=最小高度，返回i的值，i的值就是最小高度图片的索引
        if (onlyOneColsArr[i]==min) {
            return i;
        }
    }
}
</script>